{# templates/main/intro.html #}
<!DOCTYPE html>
{% load static %}
<html lang="ko" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no, shrink-to-fit=no">
    <title>{{ page_title }} - ì–´ë•í•´</title>

    <!-- 100% ì¤Œ ê³ ì • ë° ìŠ¤í¬ë¡¤ ì¤Œ ë°©ì§€ -->
    <style>
    /* ì „ì²´ í˜ì´ì§€ 100% ì¤Œ ê³ ì • */
    html {
        zoom: 1.0;
        -moz-transform: scale(1.0);
        -moz-transform-origin: 0 0;
        -webkit-transform: scale(1.0);
        -webkit-transform-origin: 0 0;
        transform: scale(1.0);
        transform-origin: 0 0;
        
        /* ì‚¬ìš©ìì˜ ì¤Œ ì¡°ì • ë°©ì§€ */
        -webkit-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
        
        /* í„°ì¹˜ ì¤Œ ë°©ì§€ */
        -webkit-touch-callout: none;
        -webkit-tap-highlight-color: transparent;
        touch-action: pan-y;
    }

    /* Firefox ì „ìš© ë³´ì • */
    @-moz-document url-prefix() {
        html {
            zoom: 1;
            -moz-transform: scale(1.0);
            width: 100%; /* 100% / 1.0 = 100% */
            height: 100%;
        }
        
        body {
            width: 100vw;
            height: 100vh;
            overflow-x: hidden;
        }
    }

    /* ìŠ¤í¬ë¡¤ë°” ì˜ì—­ ì¡°ì • */
    body {
        width: 100vw;
        height: 100vh;
        overflow-x: hidden;
    }

    /* ë§ˆìš°ìŠ¤ íœ  ì¤Œ ë°©ì§€ */
    .zoom-disabled {
        pointer-events: auto;
    }

    /* í‚¤ë³´ë“œ ì¤Œ ë‹¨ì¶•í‚¤ ë°©ì§€ë¥¼ ìœ„í•œ í¬ì»¤ìŠ¤ ì œê±° */
    * {
        outline: none;
    }

    /* ë•ë‹´ ì¹´ë“œ ì „ìš© ì¶”ê°€ ìŠ¤íƒ€ì¼ */
    .intro-btn {
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
        padding: 0.75rem 1.5rem;
        background: rgba(255, 255, 255, 0.2);
        border: 1px solid rgba(255, 255, 255, 0.3);
        color: white;
        text-decoration: none;
        border-radius: 25px;
        font-weight: 500;
        transition: all 0.3s ease;
        backdrop-filter: blur(10px);
    }
    
    .intro-btn:hover {
        background: rgba(255, 255, 255, 0.3);
        transform: translateY(-1px);
        box-shadow: 0 4px 15px rgba(255, 255, 255, 0.2);
    }
    </style>

    <!-- ë§ˆìš°ìŠ¤ íœ  ì¤Œ ë°©ì§€ JavaScript -->
    <script>
    document.addEventListener('DOMContentLoaded', function() {
        // ë§ˆìš°ìŠ¤ íœ  + Ctrl í‚¤ ì¡°í•©ìœ¼ë¡œ ì¤Œ ë°©ì§€
        document.addEventListener('wheel', function(e) {
            if (e.ctrlKey) {
                e.preventDefault();
                return false;
            }
        }, { passive: false });
        
        // í‚¤ë³´ë“œ ì¤Œ ë‹¨ì¶•í‚¤ ë°©ì§€
        document.addEventListener('keydown', function(e) {
            // Ctrl + +, Ctrl + -, Ctrl + 0 ë°©ì§€
            if (e.ctrlKey && (e.key === '+' || e.key === '-' || e.key === '0' || e.key === '=' || e.key === '_')) {
                e.preventDefault();
                return false;
            }
            
            // Ctrl + ë§ˆìš°ìŠ¤íœ  ë°©ì§€
            if (e.ctrlKey && (e.keyCode === 107 || e.keyCode === 109 || e.keyCode === 187 || e.keyCode === 189)) {
                e.preventDefault();
                return false;
            }
        });
        
        // í„°ì¹˜ ì¤Œ ë°©ì§€ (ëª¨ë°”ì¼)
        document.addEventListener('touchstart', function(e) {
            if (e.touches.length > 1) {
                e.preventDefault();
            }
        }, { passive: false });
        
        document.addEventListener('touchmove', function(e) {
            if (e.touches.length > 1) {
                e.preventDefault();
            }
        }, { passive: false });
        
        // ë”ë¸”íƒ­ ì¤Œ ë°©ì§€ (ëª¨ë°”ì¼)
        let lastTouchEnd = 0;
        document.addEventListener('touchend', function(e) {
            const now = (new Date()).getTime();
            if (now - lastTouchEnd <= 300) {
                e.preventDefault();
            }
            lastTouchEnd = now;
        }, false);
        
        // ë¸Œë¼ìš°ì € ì¤Œ ë ˆë²¨ ê°•ì œ ì¬ì„¤ì • (ì¼ë¶€ ë¸Œë¼ìš°ì €ìš©)
        function enforceZoom() {
            if (document.body.style.zoom !== '1.0') {
                document.documentElement.style.zoom = '1.0';
                document.body.style.zoom = '1.0';
            }
        }
        
        // ì •ê¸°ì ìœ¼ë¡œ ì¤Œ ë ˆë²¨ ì²´í¬
        setInterval(enforceZoom, 500);
        
        console.log('ì–´ë•í•´ ì¸íŠ¸ë¡œ: 100% ì¤Œ ê³ ì • ëª¨ë“œ í™œì„±í™”');
    });
    </script>
    
    <!-- SEO Meta Tags -->
    <meta name="description" content="ì–´ë•í•´ - íŒ¬ë“¤ì„ ìœ„í•œ íŠ¹ë³„í•œ ê³µê°„. êµ¿ì¦ˆ ê±°ë˜, íŒ¬ ì»¤ë®¤ë‹ˆí‹°, ìƒì¼ ë‹¬ë ¥ ë“± ë•ì§ˆì˜ ëª¨ë“  ê²ƒì„ ê²½í—˜í•˜ì„¸ìš”.">
    <meta name="keywords" content="ë•ì§ˆ, êµ¿ì¦ˆê±°ë˜, íŒ¬ì»¤ë®¤ë‹ˆí‹°, K-POP, ì•„ì´ëŒ, ë•íŒœ, ë•ë‹´, ìƒì¼ë‹¬ë ¥">
    <meta name="author" content="ì–´ë•í•´">
    <meta name="robots" content="index, follow">
    
    <!-- Open Graph Meta Tags (Facebook, ì¹´ì¹´ì˜¤í†¡ ë“±) -->
    <meta property="og:title" content="ì–´ë•í•´ - íŒ¬ë“¤ì„ ìœ„í•œ íŠ¹ë³„í•œ ê³µê°„">
    <meta property="og:description" content="êµ¿ì¦ˆ ê±°ë˜, íŒ¬ ì»¤ë®¤ë‹ˆí‹°, ìƒì¼ ë‹¬ë ¥ ë“± ë•ì§ˆì˜ ëª¨ë“  ê²ƒì„ í•œ ê³³ì—ì„œ ê²½í—˜í•˜ì„¸ìš”.">
    <meta property="og:image" content="{% static 'image/slide/intro_slide_default.jpg' %}">
    <meta property="og:url" content="{{ request.build_absolute_uri }}">
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="ì–´ë•í•´">
    
    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="ì–´ë•í•´ - íŒ¬ë“¤ì„ ìœ„í•œ íŠ¹ë³„í•œ ê³µê°„">
    <meta name="twitter:description" content="êµ¿ì¦ˆ ê±°ë˜, íŒ¬ ì»¤ë®¤ë‹ˆí‹°, ìƒì¼ ë‹¬ë ¥ ë“± ë•ì§ˆì˜ ëª¨ë“  ê²ƒì„ í•œ ê³³ì—ì„œ ê²½í—˜í•˜ì„¸ìš”.">
    <meta name="twitter:image" content="{% static 'image/slide/intro_slide_default.jpg' %}">
    
    <!-- Performance Optimization -->
    <link rel="preload" href="{% static 'image/slide/intro_slide_default.jpg' %}" as="image">
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="{% static 'favicon.ico' %}">
    <link rel="apple-touch-icon" href="{% static 'apple-touch-icon.png' %}">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- ì¸íŠ¸ë¡œ ë¡œê³  ì „ìš© CSS ì¶”ê°€ -->
    <link rel="stylesheet" href="{% static 'css/intro/intro_logo.css' %}">

    <!-- ê¸°ì¡´ CSS ë§í¬ ì•„ë˜ì— ì¶”ê°€ -->
    <link rel="stylesheet" href="{% static 'css/intro/intro_ddokfarm.css' %}">
    <link rel="stylesheet" href="{% static 'css/intro/intro_ddokdam.css' %}">
    <link rel="stylesheet" href="{% static 'css/intro/cafe_map.css' %}">
    <link rel="stylesheet" href="{% static 'css/intro/safety_intro.css' %}">
    <link rel="stylesheet" href="{% static 'css/intro/favorite_artists_intro.css' %}">
    <link rel="stylesheet" href="{% static 'css/intro/ddokgame_intro.css' %}">
    
    <!-- ì»¤ìŠ¤í…€ ìŠ¤íƒ€ì¼ -->
    <style>
        /* ìŠ¤í¬ë¡¤ë°” ìˆ¨ê¸°ê¸° - ëª¨ë“  ë¸Œë¼ìš°ì € ëŒ€ì‘ */
        .snap-container {
            scroll-snap-type: y mandatory;
            scroll-behavior: smooth;
            /* ìŠ¤í¬ë¡¤ë°” ìˆ¨ê¸°ê¸° */
            scrollbar-width: none; /* Firefox */
            -ms-overflow-style: none; /* Internet Explorer 10+ */
        }

        .snap-container::-webkit-scrollbar {
            display: none; /* Chrome, Safari, Opera */
        }

        /* body ì „ì²´ ìŠ¤í¬ë¡¤ë°”ë„ ìˆ¨ê¸°ê¸° */
        body {
            scrollbar-width: none; /* Firefox */
            -ms-overflow-style: none; /* Internet Explorer 10+ */
        }

        body::-webkit-scrollbar {
            display: none; /* Chrome, Safari, Opera */
        }

        /* ìŠ¤í¬ë¡¤ ìŠ¤ëƒ… ì„¤ì • */
        .snap-container {
            scroll-snap-type: y mandatory;
            scroll-behavior: smooth;
        }
        
        .snap-section {
            scroll-snap-align: start;
            scroll-snap-stop: always;
        }
        
        /* ì´ë¯¸ì§€ ìµœì í™” */
        .intro-image {
            object-fit: cover;
            object-position: center;
            width: 100%;
            height: 100vh;
            /* ì´ë¯¸ì§€ ì••ì¶• í’ˆì§ˆ í–¥ìƒ */
            image-rendering: -webkit-optimize-contrast;
            image-rendering: optimize-contrast;
            /* ë ˆì´ì§€ ë¡œë”© ì§€ì› */
            content-visibility: auto;
        }
        
        /* ê³ í•´ìƒë„ ë””ìŠ¤í”Œë ˆì´ ëŒ€ì‘ */
        @media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi) {
            .intro-image {
                image-rendering: -webkit-optimize-contrast;
                image-rendering: crisp-edges;
            }
        }
        
        /* ì ‘ê·¼ì„± ê°œì„  - ëª¨ì…˜ ê°ì†Œ ì„¤ì • */
        @media (prefers-reduced-motion: reduce) {
            .snap-container {
                scroll-behavior: auto;
            }
            
            .fade-in,
            .scroll-indicator,
            .nav-dot {
                animation: none;
                transition: none;
            }
            
            .loading-spinner {
                animation: none;
            }
        }
        
        /* ì¸í„°ë„· ìµìŠ¤í”Œë¡œëŸ¬ ëŒ€ì‘ */
        @media screen and (-ms-high-contrast: active), (-ms-high-contrast: none) {
            .intro-image {
                object-fit: cover;
                height: 100vh;
            }
        }
        
        /* ëª¨ë°”ì¼ì—ì„œ ì´ë¯¸ì§€ ë¹„ìœ¨ ìœ ì§€ */
        @media (max-width: 768px) {
            .intro-image {
                object-fit: contain;
                background-color: #f8fafc;
            }
        }
        
        /* ë„¤ë¹„ê²Œì´ì…˜ ë„íŠ¸ */
        .nav-dot {
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }
        
        .nav-dot.active {
            transform: scale(1.3);
            background-color: white;
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
        }
        
        /* ìŠ¤í¬ë¡¤ ì¸ë””ì¼€ì´í„° ì• ë‹ˆë©”ì´ì…˜ */
        .scroll-indicator {
            animation: bounce 2s infinite;
        }
        
        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% {
                transform: translateY(0);
            }
            40% {
                transform: translateY(-10px);
            }
            60% {
                transform: translateY(-5px);
            }
        }
        
        /* ë¡œë”© ìŠ¤í”¼ë„ˆ */
        .loading-spinner {
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top: 3px solid white;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* ì˜¤ë²„ë ˆì´ ì½˜í…ì¸  í˜ì´ë“œ ì¸ */
        .fade-in {
            opacity: 0;
            transform: translateY(30px);
            transition: all 0.8s ease;
        }
        
        .fade-in.visible {
            opacity: 1;
            transform: translateY(0);
        }
        
        /* ë„¤ë¹„ê²Œì´ì…˜ ë„íŠ¸ ì»¨í…Œì´ë„ˆ ìŠ¤í¬ë¡¤ */
        .nav-dots-container {
            max-height: 80vh;
            overflow-y: auto;
            scrollbar-width: none; /* Firefox */
            -ms-overflow-style: none; /* Internet Explorer 10+ */
        }

        .nav-dots-container::-webkit-scrollbar {
            display: none; /* Chrome, Safari, Opera */
        }
                
                /* í†µê³„ ì¹´ìš´í„° ì• ë‹ˆë©”ì´ì…˜ */
                .counter {
                    font-variant-numeric: tabular-nums;
                }
    </style>
</head>
<body class="bg-gray-900 overflow-x-hidden">
    
    <!-- ë¡œë”© í™”ë©´ -->
    <div id="loading" class="fixed inset-0 bg-black z-50 flex items-center justify-center transition-opacity duration-500">
        <div class="text-center text-white">
            <div class="loading-spinner mx-auto mb-4"></div>
            <div class="text-lg font-light">ì–´ë•í•´ ë¡œë”© ì¤‘...</div>
        </div>
    </div>
    
    <!-- ìƒë‹¨ ë„¤ë¹„ê²Œì´ì…˜ ë°” -->
    <nav class="fixed top-0 left-0 right-0 z-40 bg-black bg-opacity-80 backdrop-blur-md">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <!-- ë¡œê³  -->
                <div class="flex-shrink-0">
                    <a href="/" class="text-white text-xl font-bold hover:text-gray-300 transition-colors">
                        ì–´ë•í•´
                    </a>
                </div>
            </div>
        </div>
    </nav>
    
    <!-- ìš°ì¸¡ ë„¤ë¹„ê²Œì´ì…˜ ë„íŠ¸ -->
    <div class="fixed right-4 md:right-8 top-1/2 transform -translate-y-1/2 z-40">
        <div class="nav-dots-container space-y-2">
            {% for slide in slide_contents %}
            <div class="nav-dot w-1 h-1 bg-white bg-opacity-50 rounded-full cursor-pointer transition-all hover:bg-opacity-80 {% if forloop.first %}active{% endif %}" 
                 data-section="{{ forloop.counter0 }}" 
                 title="{{ slide.subtitle }}"></div>
            {% endfor %}
        </div>
    </div>
    
    <!-- ë©”ì¸ ì»¨í…Œì´ë„ˆ -->
    <main class="h-screen overflow-y-auto snap-container" id="main-container">
        
        <!-- ìŠ¬ë¼ì´ë“œ ë™ì  ìƒì„± -->
        {% for slide in slide_contents %}
        <section class="snap-section h-screen relative" id="section-{{ forloop.counter0 }}">
            <img src="{% static slide.image %}" 
                 alt="ì–´ë•í•´ ì†Œê°œ ìŠ¬ë¼ì´ë“œ {{ forloop.counter }} - {{ slide.title }}" 
                 class="intro-image"
                 loading="eager">
            
            <!-- ìŠ¬ë¼ì´ë“œë³„ ì˜¤ë²„ë ˆì´ ì½˜í…ì¸  -->
            <div class="absolute inset-0 bg-black bg-opacity-40 flex items-center justify-center">
                <div class="text-center text-white fade-in px-4 max-w-4xl">
                    
                    {% if slide.type == 'welcome' %}
                    <!-- ì²« ë²ˆì§¸ ìŠ¬ë¼ì´ë“œ - ì›°ì»´ -->
                    <h1 class="text-4xl md:text-6xl font-bold mb-6">{{ slide.title }}</h1>
                    <p class="text-lg md:text-xl mb-8 max-w-2xl mx-auto">
                        {{ slide.subtitle }}<br> 
                        {{ slide.description }}
                    </p>
                    <!--ë¡œê³  ì´ë¯¸ì§€ ì¶”ê°€ -->
                    <div class="logo-container mb-6">
                        <img src="{% static 'image/ddok_logo_filled.png' %}" 
                            alt="ì–´ë•í•´ ë¡œê³ " 
                            class="intro-logo mx-auto w-24 h-24 md:w-32 md:h-32 lg:w-40 lg:h-40 object-contain drop-shadow-2xl">
                    </div>

                    {% elif slide.type == 'cta' %}
                    <!-- ë§ˆì§€ë§‰ ìŠ¬ë¼ì´ë“œ - CTA -->
                    <h2 class="text-4xl md:text-6xl font-bold mb-6">{{ slide.title }}</h2>
                    <p class="text-lg md:text-xl mb-8 max-w-3xl mx-auto">
                        {{ slide.subtitle }}<br>
                        {{ slide.description }}
                    </p>
                    
                    <!-- í†µê³„ ì •ë³´ -->
                    {% if stats.total_users > 0 %}
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-6 mb-8 max-w-2xl mx-auto">
                        <div class="text-center">
                            <div class="text-2xl md:text-3xl font-bold counter">{{ stats.total_users }}</div>
                            <div class="text-sm opacity-80">í™œì„± ì‚¬ìš©ì</div>
                        </div>
                        <div class="text-center">
                            <div class="text-2xl md:text-3xl font-bold counter">{{ stats.total_artists }}</div>
                            <div class="text-sm opacity-80">ë“±ë¡ ì•„í‹°ìŠ¤íŠ¸</div>
                        </div>
                        <div class="text-center">
                            <div class="text-2xl md:text-3xl font-bold counter">{{ stats.total_posts }}</div>
                            <div class="text-sm opacity-80">ê²Œì‹œë¬¼</div>
                        </div>
                        <div class="text-center">
                            <div class="text-2xl md:text-3xl font-bold counter">{{ stats.total_trades }}</div>
                            <div class="text-sm opacity-80">ê±°ë˜ ì™„ë£Œ</div>
                        </div>
                    </div>
                    {% endif %}
                    
                    <!-- CTA ë²„íŠ¼ -->
                    <div class="flex flex-col sm:flex-row gap-4 justify-center items-center">
                        {% if not user.is_authenticated %}
                            <a href="/accounts/signup/" 
                               class="bg-blue-600 hover:bg-blue-700 text-white px-8 py-4 rounded-full text-lg font-semibold transition-all transform hover:scale-105 shadow-xl">
                                ì§€ê¸ˆ ì‹œì‘í•˜ê¸°
                            </a>
                            <a href="/" 
                               class="border-2 border-white text-white hover:bg-white hover:text-black px-8 py-4 rounded-full text-lg font-semibold transition-all">
                                ë‘˜ëŸ¬ë³´ê¸°
                            </a>
                        {% else %}
                            <a href="/" 
                               class="bg-white text-black hover:bg-gray-100 px-8 py-4 rounded-full text-lg font-semibold transition-all transform hover:scale-105 shadow-xl">
                                ë©”ì¸ìœ¼ë¡œ ëŒì•„ê°€ê¸°
                            </a>
                        {% endif %}
                    </div>
                    
                    {% else %}
                    <!-- ëª¨ë“  ì¼ë°˜ ìŠ¬ë¼ì´ë“œì˜ ê³µí†µ í—¤ë” -->
                    <h2 class="text-3xl md:text-5xl font-bold mb-4">{{ slide.title }}</h2>
                    <h3 class="text-xl md:text-2xl mb-6 text-pink-200">{{ slide.subtitle }}</h3>
                    <p class="text-base md:text-lg max-w-2xl mx-auto leading-relaxed mb-6">
                        {{ slide.description }}
                    </p>

                    <!-- ìŠ¬ë¼ì´ë“œ íƒ€ì…ë³„ ì½˜í…ì¸ ë§Œ -->
                    {% if slide.type == 'ddokfarm' %}
                        {% include 'main/intro/intro_ddokfarm_form.html' %}

                    {% elif slide.type == 'ddokdam' %}
                        {% include 'main/intro/intro_ddokdam_form.html' %}

                    {% elif slide.type == 'favorite_artists' %}
                        {% include 'main/intro/favorite_artists_slide.html' %}

                    {% elif slide.type == 'ddoksang' %}
                        {% include 'main/intro/cafe_map_slide.html' %}

                    {% elif slide.type == 'ddokchat' %}
                        {% include 'main/intro/ddokchat_slide.html' %}
                        
                    {% elif slide.type == 'safety' %}
                        {% include 'main/intro/safety_slide.html' %}

                    {% elif slide.type == 'ddokgame' %}
                        {% include 'main/intro/ddokgame_slide.html' %}
                    {% endif %}

                    {% endif %}
                </div>
            </div>
            
            {% if forloop.first %}
            <!-- ì²« ë²ˆì§¸ ìŠ¬ë¼ì´ë“œì—ë§Œ ìŠ¤í¬ë¡¤ íŒíŠ¸ í‘œì‹œ -->
            <div class="scroll-indicator absolute bottom-8 left-1/2 transform -translate-x-1/2 text-white text-center">
                <svg class="w-6 h-6 mx-auto opacity-80" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 14l-7 7m0 0l-7-7m7 7V3"/>
                </svg>
            </div>
            {% endif %}
        </section>
        {% endfor %}
        
    </main>

    <!-- ì§„í–‰ë¥  í‘œì‹œë°” -->
    <div class="fixed bottom-0 left-0 right-0 z-30">
        <div class="bg-gray-800 bg-opacity-50 h-1">
            <div id="progress-bar" class="bg-white h-full transition-all duration-300" style="width: 0%"></div>
        </div>
    </div>

    <!-- JavaScript íŒŒì¼ë“¤ì„ body ì•ˆìª½ì— ë¡œë“œ -->
    <script src="{% static 'js/intro/intro_ddokfarm.js' %}"></script>
    <script src="{% static 'js/intro/intro_ddokdam.js' %}"></script>
    <script src="{% static 'js/intro/favorite_artists_intro.js' %}"></script>
    <script src="{% static 'js/intro/ddokgame_intro.js' %}"></script>
    
    <!-- ë©”ì¸ JavaScript -->
    <script>
        // ì „ì—­ ë³€ìˆ˜
        let currentSection = 0;
        const totalSections = {{ total_slides }};
        let isScrolling = false;
        let touchStartY = 0;
        
        // DOM ìš”ì†Œ
        const mainContainer = document.getElementById('main-container');
        const loading = document.getElementById('loading');
        const navDots = document.querySelectorAll('.nav-dot');
        const progressBar = document.getElementById('progress-bar');
        
        // ì´ë¯¸ì§€ ë¡œë”© ê´€ë¦¬
        function checkImagesLoaded() {
            console.log('ë‹¨ì¼ ì´ë¯¸ì§€ ë¡œë”© ì²´í¬ ì‹œì‘...');
            
            const firstImage = document.querySelector('.intro-image');
            
            if (firstImage && firstImage.complete && firstImage.naturalHeight !== 0) {
                console.log('ì´ë¯¸ì§€ ë¡œë”© ì™„ë£Œ');
                finishLoading();
            } else {
                setTimeout(() => {
                    console.log('1ì´ˆ íƒ€ì„ì•„ì›ƒ, ê°•ì œ ë¡œë”© ì™„ë£Œ');
                    finishLoading();
                }, 1000);
            }
        }
        
        function finishLoading() {
            console.log('ë¡œë”© ì™„ë£Œ ì²˜ë¦¬ ì‹œì‘');
            loading.style.opacity = '0';
            setTimeout(() => {
                loading.style.display = 'none';
                initializeApp();
                console.log('ì•± ì´ˆê¸°í™” ì™„ë£Œ');
            }, 500);
        }
        
        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', () => {
            console.log('DOM ë¡œë“œ ì™„ë£Œ');
            // JavaScript íŒŒì¼ë“¤ì´ ë¡œë“œë˜ê¸°ë¥¼ ì ì‹œ ê¸°ë‹¤ë¦¼
            setTimeout(() => {
                checkImagesLoaded();
            }, 200);
        });
        
        window.addEventListener('load', () => {
            console.log('ìœˆë„ìš° ë¡œë“œ ì™„ë£Œ');
            if (loading.style.display !== 'none') {
                console.log('ë°±ì—… ë¡œë”© ì™„ë£Œ ì²˜ë¦¬');
                finishLoading();
            }
        });
        
        // ì•± ì´ˆê¸°í™”
        function initializeApp() {
            updateNavigation();
            setupEventListeners();
            updateProgressBar();
            
            setTimeout(() => {
                document.querySelectorAll('.fade-in').forEach(el => {
                    el.classList.add('visible');
                });
            }, 500);
            
            if (currentSection === totalSections - 1) {
                animateCounters();
            }
        }
        
        // ì¹´ìš´í„° ì• ë‹ˆë©”ì´ì…˜
        function animateCounters() {
            const counters = document.querySelectorAll('.counter');
            counters.forEach(counter => {
                const target = parseInt(counter.textContent);
                if (target > 0) {
                    let current = 0;
                    const increment = target / 50;
                    const timer = setInterval(() => {
                        current += increment;
                        if (current >= target) {
                            current = target;
                            clearInterval(timer);
                        }
                        counter.textContent = Math.floor(current).toLocaleString();
                    }, 40);
                }
            });
        }
        
        // ë„¤ë¹„ê²Œì´ì…˜ ì—…ë°ì´íŠ¸
        function updateNavigation() {
            navDots.forEach((dot, index) => {
                if (index === currentSection) {
                    dot.classList.add('active');
                } else {
                    dot.classList.remove('active');
                }
            });
        }
        
        // ì§„í–‰ë¥  ë°” ì—…ë°ì´íŠ¸
        function updateProgressBar() {
            const progress = ((currentSection + 1) / totalSections) * 100;
            progressBar.style.width = progress + '%';
        }
        
        // ì•ˆì „í•œ ê²Œì„ ì´ˆê¸°í™” í•¨ìˆ˜ (ê°•í™”ëœ ë²„ì „)
        function safeInitDdokGame() {
            console.log('ğŸ® ì•ˆì „í•œ ê²Œì„ ì´ˆê¸°í™” ì‹œì‘');
            
            let retryCount = 0;
            const maxRetries = 15;
            
            function attemptInit() {
                console.log(`ğŸ® ì´ˆê¸°í™” ì‹œë„ ${retryCount + 1}/${maxRetries}`);
                
                // ê¸°ì¡´ ì¸ìŠ¤í„´ìŠ¤ ì •ë¦¬
                if (typeof window.destroyDdokGameIntroSlide === 'function') {
                    try {
                        window.destroyDdokGameIntroSlide();
                        console.log('ğŸ® ê¸°ì¡´ ì¸ìŠ¤í„´ìŠ¤ ì •ë¦¬ ì™„ë£Œ');
                    } catch (e) {
                        console.warn('ğŸ® ê¸°ì¡´ ì¸ìŠ¤í„´ìŠ¤ ì •ë¦¬ ì¤‘ ì—ëŸ¬:', e);
                    }
                }
                
                // 1ìˆœìœ„: initDdokGameIntroSlide í•¨ìˆ˜ ì‚¬ìš©
                if (typeof window.initDdokGameIntroSlide === 'function') {
                    try {
                        console.log('ğŸ® initDdokGameIntroSlide í•¨ìˆ˜ë¡œ ì´ˆê¸°í™”');
                        window.initDdokGameIntroSlide();
                        console.log('ğŸ® ê²Œì„ ì´ˆê¸°í™” ì„±ê³µ!');
                        return true;
                    } catch (e) {
                        console.error('ğŸ® í•¨ìˆ˜ ì´ˆê¸°í™” ì‹¤íŒ¨:', e);
                    }
                }
                
                // 2ìˆœìœ„: DdokGameIntroSlide í´ë˜ìŠ¤ ì§ì ‘ ì‚¬ìš©
                if (typeof window.DdokGameIntroSlide === 'function') {
                    try {
                        console.log('ğŸ® í´ë˜ìŠ¤ë¡œ ì§ì ‘ ì´ˆê¸°í™”');
                        window.ddokGameIntroSlide = new window.DdokGameIntroSlide();
                        console.log('ğŸ® í´ë˜ìŠ¤ ì´ˆê¸°í™” ì„±ê³µ!');
                        return true;
                    } catch (e) {
                        console.error('ğŸ® í´ë˜ìŠ¤ ì´ˆê¸°í™” ì‹¤íŒ¨:', e);
                    }
                }
                
                // 3ìˆœìœ„: ëŒ€ì²´ ì´ˆê¸°í™”
                if (fallbackGameInit()) {
                    console.log('ğŸ® ëŒ€ì²´ ì´ˆê¸°í™” ì„±ê³µ!');
                    return true;
                }
                
                return false;
            }
            
            // ì´ˆê¸°í™” ì‹œë„
            if (attemptInit()) {
                return;
            }
            
            // ì‹¤íŒ¨ì‹œ ì¬ì‹œë„
            retryCount++;
            if (retryCount < maxRetries) {
                console.log(`ğŸ® ${retryCount * 300}ms í›„ ì¬ì‹œë„`);
                setTimeout(() => {
                    safeInitDdokGame();
                }, retryCount * 300); // ì ì§„ì ìœ¼ë¡œ ì§€ì—° ì‹œê°„ ì¦ê°€
            } else {
                console.error('ğŸ® ìµœëŒ€ ì¬ì‹œë„ íšŸìˆ˜ ì´ˆê³¼, ëŒ€ì²´ ì´ˆê¸°í™” ì‹¤í–‰');
                fallbackGameInit();
            }
        }
        
        // ëŒ€ì²´ ì´ˆê¸°í™” í•¨ìˆ˜ (ê°•í™”ëœ ë²„ì „)
        function fallbackGameInit() {
            console.log('ğŸ® ëŒ€ì²´ ì´ˆê¸°í™” ì‹œì‘');
            
            // ê¸°ë³¸ì ì¸ ì‹œê°„ í‘œì‹œë§Œ êµ¬í˜„
            const timeMain = document.querySelector('.time-main');
            const timeMs = document.querySelector('.time-ms');
            
            if (timeMain && timeMs) {
                console.log('ğŸ® ì‹œê°„ í‘œì‹œ ìš”ì†Œ ë°œê²¬, ê¸°ë³¸ ì‹œê°„ í‘œì‹œ ì‹œì‘');
                
                let animationId = null;
                
                const updateTime = () => {
                    const now = new Date();
                    const hours = String(now.getHours()).padStart(2, '0');
                    const minutes = String(now.getMinutes()).padStart(2, '0');
                    const seconds = String(now.getSeconds()).padStart(2, '0');
                    const milliseconds = String(now.getMilliseconds()).padStart(3, '0');
                    
                    timeMain.textContent = `${hours}:${minutes}:${seconds}`;
                    timeMs.textContent = `.${milliseconds}`;
                    
                    animationId = requestAnimationFrame(updateTime);
                };
                
                updateTime();
                
                // ì •ë¦¬ í•¨ìˆ˜ë¥¼ ì „ì—­ì— ì €ì¥
                window.fallbackCleanup = () => {
                    if (animationId) {
                        cancelAnimationFrame(animationId);
                        animationId = null;
                        console.log('ğŸ® ëŒ€ì²´ ì‹œê°„ í‘œì‹œ ì •ë¦¬ ì™„ë£Œ');
                    }
                };
                
                console.log('ğŸ® ëŒ€ì²´ ì‹œê°„ í‘œì‹œ ì‹œì‘ ì™„ë£Œ');
                return true;
            } else {
                console.warn('ğŸ® ì‹œê°„ í‘œì‹œ ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ');
                return false;
            }
        }
        
        // íŠ¹ì • ì„¹ì…˜ìœ¼ë¡œ ì´ë™
        function goToSection(sectionIndex) {
            if (sectionIndex < 0 || sectionIndex >= totalSections || isScrolling) return;
            
            isScrolling = true;
            currentSection = sectionIndex;
            
            const targetSection = document.getElementById(`section-${sectionIndex}`);
            targetSection.scrollIntoView({ 
                behavior: 'smooth',
                block: 'start'
            });
            
            updateNavigation();
            updateProgressBar();

            // ğŸ® ê²Œì„ ìŠ¬ë¼ì´ë“œ ê°ì§€
            const gameSlideIndex = 7; // ddokgame ìŠ¬ë¼ì´ë“œ ì¸ë±ìŠ¤
            if (sectionIndex === gameSlideIndex) {
                console.log('ğŸ® ê²Œì„ ìŠ¬ë¼ì´ë“œ ì§„ì…:', sectionIndex);
                setTimeout(() => {
                    safeInitDdokGame();
                }, 1000); // 1ì´ˆ í›„ì— ì´ˆê¸°í™” (ì¶©ë¶„í•œ ì—¬ìœ  ì‹œê°„)
            } else {
                // ë‹¤ë¥¸ ìŠ¬ë¼ì´ë“œë¡œ ì´ë™ì‹œ ê²Œì„ ì •ë¦¬
                if (typeof window.destroyDdokGameIntroSlide === 'function') {
                    try {
                        window.destroyDdokGameIntroSlide();
                        console.log('ğŸ® ê²Œì„ ì¸ìŠ¤í„´ìŠ¤ ì •ë¦¬ ì™„ë£Œ');
                    } catch (e) {
                        console.warn('ğŸ® ê²Œì„ ì •ë¦¬ ì¤‘ ì—ëŸ¬:', e);
                    }
                }
                if (typeof window.fallbackCleanup === 'function') {
                    window.fallbackCleanup();
                }
            }
            
            // ë§ˆì§€ë§‰ ìŠ¬ë¼ì´ë“œì—ì„œ ì¹´ìš´í„° ì• ë‹ˆë©”ì´ì…˜ ì‹¤í–‰
            if (sectionIndex === totalSections - 1) {
                setTimeout(() => {
                    animateCounters();
                }, 500);
            }
            
            setTimeout(() => {
                isScrolling = false;
            }, 1200);
        }
        
        // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„¤ì •
        function setupEventListeners() {
            // ë„¤ë¹„ê²Œì´ì…˜ ë„íŠ¸ í´ë¦­
            navDots.forEach((dot, index) => {
                dot.addEventListener('click', () => goToSection(index));
            });
            
            // í‚¤ë³´ë“œ ë„¤ë¹„ê²Œì´ì…˜
            document.addEventListener('keydown', (e) => {
                if (isScrolling) return;
                
                switch(e.key) {
                    case 'ArrowDown':
                    case ' ':
                        e.preventDefault();
                        if (currentSection < totalSections - 1) {
                            goToSection(currentSection + 1);
                        }
                        break;
                    case 'ArrowUp':
                        e.preventDefault();
                        if (currentSection > 0) {
                            goToSection(currentSection - 1);
                        }
                        break;
                    case 'Home':
                        e.preventDefault();
                        goToSection(0);
                        break;
                    case 'End':
                        e.preventDefault();
                        goToSection(totalSections - 1);
                        break;
                }
            });
            
            // í„°ì¹˜ ì´ë²¤íŠ¸ (ëª¨ë°”ì¼)
            mainContainer.addEventListener('touchstart', (e) => {
                touchStartY = e.touches[0].clientY;
            }, { passive: true });
            
            mainContainer.addEventListener('touchend', (e) => {
                if (isScrolling) return;
                
                const touchEndY = e.changedTouches[0].clientY;
                const diff = touchStartY - touchEndY;
                const threshold = 50;
                
                if (Math.abs(diff) > threshold) {
                    if (diff > 0 && currentSection < totalSections - 1) {
                        goToSection(currentSection + 1);
                    } else if (diff < 0 && currentSection > 0) {
                        goToSection(currentSection - 1);
                    }
                }
            }, { passive: true });
            
            // ìŠ¤í¬ë¡¤ ì´ë²¤íŠ¸ ê°ì§€
            let scrollTimeout;
            mainContainer.addEventListener('scroll', () => {
                clearTimeout(scrollTimeout);
                scrollTimeout = setTimeout(() => {
                    if (!isScrolling) {
                        detectCurrentSection();
                    }
                }, 100);
            }, { passive: true });
        }
        
        // í˜„ì¬ ì„¹ì…˜ ê°ì§€
        function detectCurrentSection() {
            const scrollTop = mainContainer.scrollTop;
            const windowHeight = window.innerHeight;
            const newSection = Math.round(scrollTop / windowHeight);
            
            if (newSection !== currentSection && newSection >= 0 && newSection < totalSections) {
                currentSection = newSection;
                updateNavigation();
                updateProgressBar();
                
                // ê²Œì„ ìŠ¬ë¼ì´ë“œ ìë™ ê°ì§€
                if (currentSection === 7) {
                    setTimeout(() => {
                        safeInitDdokGame();
                    }, 800);
                } else {
                    // ë‹¤ë¥¸ ìŠ¬ë¼ì´ë“œì—ì„œëŠ” ê²Œì„ ì •ë¦¬
                    if (typeof window.destroyDdokGameIntroSlide === 'function') {
                        try {
                            window.destroyDdokGameIntroSlide();
                        } catch (e) {
                            console.warn('ğŸ® ìë™ ê²Œì„ ì •ë¦¬ ì¤‘ ì—ëŸ¬:', e);
                        }
                    }
                    if (typeof window.fallbackCleanup === 'function') {
                        window.fallbackCleanup();
                    }
                }
                
                // ë§ˆì§€ë§‰ ìŠ¬ë¼ì´ë“œì—ì„œ ì¹´ìš´í„° ì• ë‹ˆë©”ì´ì…˜
                if (currentSection === totalSections - 1) {
                    animateCounters();
                }
            }
        }
        
        console.log(`ì–´ë•í•´ ì†Œê°œ í˜ì´ì§€ ë¡œë“œ ì™„ë£Œ - ${totalSections}ê°œ ìŠ¬ë¼ì´ë“œ`);
    </script>
</body>
</html>