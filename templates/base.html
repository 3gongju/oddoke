<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Oddoke</title>
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- âœ… ì¶”ê°€: ì„œë¸Œ í…œí”Œë¦¿ì—ì„œ head ì˜ì—­ í™•ì¥ ê°€ëŠ¥í•˜ê²Œ -->
    {% block head %}{% endblock %}
</head>
<body class="bg-gray-50 text-gray-900 min-h-screen">

<!-- Navbar -->
<nav class="bg-white shadow sticky top-0 z-50">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="flex justify-between h-16 items-center">
      <!-- ë¡œê³  + ë©”ë‰´ -->
      <div class="flex items-center space-x-4">
        <a href="/" class="text-xl font-bold text-primary">ì–´ë•í•´</a>
        <a href="/ddokfarm/" class="hover:text-primary text-sm font-medium">ë•íŒœ</a>
        <a href="/ddokdam/" class="hover:text-primary text-sm font-medium">ë•ë‹´</a>
        <a href="#" class="hover:text-primary text-sm font-medium">ë•ìƒ</a>
      </div>

      <!-- ë¡œê·¸ì¸ ìƒíƒœë³„ ë²„íŠ¼ -->
      <div class="flex items-center space-x-2">
        {% if request.user.is_authenticated %}
          <span class="text-sm text-gray-700">ğŸ‘¤ {{ request.user.username }}ë‹˜</span>
          <a href="{% url 'accounts:profile' user.username %}" class="text-sm text-gray-700 hover:text-primary">ë§ˆì´í˜ì´ì§€</a>
          <a href="/accounts/logout/" class="text-sm text-gray-700 hover:text-primary">ë¡œê·¸ì•„ì›ƒ</a>
        {% else %}
          <a href="/accounts/login/" class="text-sm text-gray-700 hover:text-primary">ë¡œê·¸ì¸</a>
        {% endif %}
      </div>
    </div>
  </div>
</nav>

<!-- âœ… ë³¸ë¬¸ ë¸”ë¡ -->
{% block body %}
{% endblock %}

<!-- ì¢‹ì•„ìš” í•˜íŠ¸ ë¹„ë™ê¸° ì²˜ë¦¬ -->
<script>
  document.addEventListener("DOMContentLoaded", function() {
    document.querySelectorAll(".like-toggle").forEach(btn => {
      btn.addEventListener("click", function() {
        const postId = this.dataset.postId;
        const csrftoken = document.querySelector('[name=csrfmiddlewaretoken]').value;

        fetch(`/ddokfarm/${postId}/like/`, {
          method: "POST",
          headers: {
            "X-CSRFToken": csrftoken,
            "Content-Type": "application/json"
          }
        })
        .then(response => response.json())
        .then(data => {
          const heartSpan = this.querySelector(".heart-icon");
          heartSpan.textContent = data.liked ? "â¤ï¸" : "ğŸ¤";
        })
        .catch(error => console.error("ì—ëŸ¬:", error));
      });
    });
  });
</script>

</body>
</html>
