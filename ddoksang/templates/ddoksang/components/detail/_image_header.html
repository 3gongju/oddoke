<!-- ÎîîÌÖåÏùº ÌéòÏù¥ÏßÄ Ïù¥ÎØ∏ÏßÄ Ìó§Îçî Ïª¥Ìè¨ÎÑåÌä∏ -->

<style>
.text-info-bar {
  background: linear-gradient(135deg, rgba(255, 255, 255, 0.95) 0%, rgba(255, 255, 255, 0.9) 100%);
  backdrop-filter: blur(20px);
  border-left: none;
  border-right: none;
  
  position: relative;
}

.text-info-bar::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 1px;
  background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.6), transparent);
}

.text-info-bar::after {
  content: '';
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  height: 1px;
  background: linear-gradient(90deg, transparent, rgba(0, 0, 0, 0.1), transparent);
}

@media (max-width: 768px) {
  .text-info-bar {
    background: linear-gradient(135deg, rgba(255, 255, 255, 0.92) 0%, rgba(255, 255, 255, 0.88) 100%);
    backdrop-filter: blur(15px);
  }
}
</style>

<div class="relative">
  <!-- Ïù¥ÎØ∏ÏßÄ Ïä¨ÎùºÏù¥Îìú Ï†ÑÏ≤¥ ÏòÅÏó≠ - ÌÅ¨Í∏∞ Ï∂ïÏÜå -->
  <div class="relative overflow-hidden mt-16" style="max-width: 600px; margin: 0 auto;">
    {% with all_images=cafe.get_all_images %}
      {% if all_images %}
        <div id="imageGallery" class="relative w-full h-[350px]">
          {% for image in all_images %}
            <div class="gallery-slide absolute inset-0 opacity-0 transition-opacity duration-500 {% if forloop.first %}opacity-100{% endif %}"
                 onclick="window.openImageModal({{ forloop.counter0 }})">
              <div class="flex items-center justify-center w-full h-full bg-white rounded-lg">
                <img src="{{ image.url }}" alt="{{ image.caption|default:cafe.cafe_name }}"
                     class="object-contain max-h-[330px] w-auto h-auto cursor-zoom-in rounded-lg shadow-lg">
              </div>
            </div>
          {% endfor %}

          {% if all_images|length > 1 %}
            <!-- Ï¢åÏö∞ ÌôîÏÇ¥Ìëú -->
            <button type="button" onclick="window.prevGalleryImage()"
                    class="gallery-nav-btn absolute left-2 top-1/2 transform -translate-y-1/2 bg-opacity-70 p-1.5 rounded-full hover:bg-black/50 transition-colors z-20">
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
              </svg>
            </button>
            <button type="button" onclick="window.nextGalleryImage()"
                    class="gallery-nav-btn absolute right-2 top-1/2 transform -translate-y-1/2 bg-opacity-70 text-gray-800 p-1.5 rounded-full hover:bg-black/50 transition-colors z-20">
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
              </svg>
            </button>
          {% endif %}
        </div>

        <!-- Ï∞ú Î≤ÑÌäº - ÌÅ¨Í∏∞ Ï∂ïÏÜå -->
        {% if user.is_authenticated and cafe.status == 'approved' %}
          <div class="absolute top-2 right-2 z-40 flex items-center justify-center">
            <button 
              data-favorite-btn 
              data-cafe-id="{{ cafe.id }}" 
              class="favorite-button w-20 h-20 text-lg bg-white bg-opacity-50 backdrop-blur-sm rounded-full hover:bg-opacity-70 transition-all focus:outline-none cursor-pointer {% if cafe.id in user_favorites %}favorited{% else %}not-favorited{% endif %}"
              style="color: {% if cafe.id in user_favorites %}#ef4444{% else %}#ffffff{% endif %};"
              title="{% if cafe.id in user_favorites %}Ï∞ú Ìï¥Ï†ú{% else %}Ï∞úÌïòÍ∏∞{% endif %}"
            >
              <span class="favorite-icon">{% if cafe.id in user_favorites %}‚ô•{% else %}‚ô°{% endif %}</span>
            </button>
          </div>
        {% endif %}
      {% else %}
        <div class="w-full h-[350px] bg-gradient-to-br from-gray-300 to-gray-500 flex items-center justify-center rounded-lg">
          <span class="text-white text-4xl">üè™</span>
        </div>
      {% endif %}
    {% endwith %}
  </div>

  <!-- ÌÖçÏä§Ìä∏ Ï†ïÎ≥¥ Î∞î - Ïù¥ÎØ∏ÏßÄ Í∞§Îü¨Î¶¨ ÌïòÎã®Ïóê Í∏∏Í≤å Ïó∞Í≤∞ -->
  <div class="text-info-bar mt-2 py-6 px-8">
    <div class="max-w-4xl mx-auto">
      <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-4">
        <!-- ÏôºÏ™Ω: ÏÉÅÌÉú Î∞è ÌÉÄÏûÖ Î∞∞ÏßÄ -->
        <div class="flex items-center gap-3">
          <span class="px-4 py-2 rounded-full text-sm font-bold text-white shadow-md
                     {% if cafe.is_active %}bg-emerald-500{% elif cafe.days_until_start > 0 %}bg-blue-500{% else %}bg-gray-500{% endif %}">
            {% if cafe.is_active %}
              ÏßÑÌñâÏ§ë
            {% elif cafe.days_until_start > 0 %}
              ÏòàÏ†ï
            {% else %}
              Ï¢ÖÎ£å
            {% endif %}
          </span>
          <span class="px-4 py-2 bg-black rounded-full text-sm font-bold text-white shadow-md">
            {{ cafe.get_cafe_type_display }}
          </span>
        </div>
        
        <!-- Ï§ëÏïô/Ïò§Î•∏Ï™Ω: Ïπ¥ÌéòÎ™ÖÍ≥º ÏïÑÌã∞Ïä§Ìä∏ Ï†ïÎ≥¥ -->
        <div class="flex-1 md:text-right">
          <h1 class="text-2xl md:text-3xl font-bold text-gray-900 mb-1 break-words leading-tight">
            {{ cafe.cafe_name }}
          </h1>
          <p class="text-lg text-gray-600 font-medium">
            {{ cafe.artist.display_name }}{% if cafe.member %} - {{ cafe.member.member_name }}{% endif %}
          </p>
        </div>
      </div>
    </div>
  </div>
</div>