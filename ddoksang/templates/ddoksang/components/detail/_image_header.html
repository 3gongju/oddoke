<!-- ÎîîÌÖåÏùº ÌéòÏù¥ÏßÄ Ïù¥ÎØ∏ÏßÄ Ìó§Îçî Ïª¥Ìè¨ÎÑåÌä∏ -->

<style>
.text-info-card {
  background: rgba(0, 0, 0, 0.8);
  backdrop-filter: blur(10px);
  border: 1px solid rgba(255, 255, 255, 0.1);
}

@media (max-width: 768px) {
  .text-info-card {
    background: rgba(0, 0, 0, 0.85);
    backdrop-filter: blur(12px);
  }
}
</style>

<div class="relative">
  <!-- Ïù¥ÎØ∏ÏßÄ Ïä¨ÎùºÏù¥Îìú Ï†ÑÏ≤¥ ÏòÅÏó≠ -->
  <div class="relative overflow-hidden mt-16">
    {% with all_images=cafe.get_all_images %}
      {% if all_images %}
        <div id="imageGallery" class="relative w-full h-[500px]">
          {% for image in all_images %}
            <div class="gallery-slide absolute inset-0 opacity-0 transition-opacity duration-500 {% if forloop.first %}opacity-100{% endif %}"
                 onclick="window.openImageModal({{ forloop.counter0 }})">
              <div class="flex items-center justify-center w-full h-full bg-white">
                <img src="{{ image.url }}" alt="{{ image.caption|default:cafe.cafe_name }}"
                     class="object-contain max-h-[480px] w-auto h-auto cursor-zoom-in rounded-lg shadow-2xl">
              </div>
            </div>
          {% endfor %}

          {% if all_images|length > 1 %}
            <!-- Ï¢åÏö∞ ÌôîÏÇ¥Ìëú -->
            <button type="button" onclick="window.prevGalleryImage()"
                    class="gallery-nav-btn absolute left-4 top-1/2 transform -translate-y-1/2 bg-black/30 text-white p-2 rounded-full hover:bg-black/50 transition-colors z-20">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
              </svg>
            </button>
            <button type="button" onclick="window.nextGalleryImage()"
                    class="gallery-nav-btn absolute right-4 top-1/2 transform -translate-y-1/2 bg-black/30 text-white p-2 rounded-full hover:bg-black/50 transition-colors z-20">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
              </svg>
            </button>
          {% endif %}

          <!-- ÌÖçÏä§Ìä∏ Ï†ïÎ≥¥ Ïπ¥Îìú -->
          <div class="absolute bottom-2 left-2 z-30">
            <div class="text-info-card rounded-xl p-4 shadow-lg max-w-sm md:max-w-md">
              <div class="flex items-center gap-2 mb-2 flex-wrap">
                <span class="px-3 py-1 rounded-full text-xs font-bold text-white shadow-sm
                           {% if cafe.is_active %}bg-green-500{% elif cafe.days_until_start > 0 %}bg-blue-500{% else %}bg-gray-500{% endif %}">
                  {% if cafe.is_active %}
                    ÏßÑÌñâÏ§ë
                  {% elif cafe.days_until_start > 0 %}
                    ÏòàÏ†ï
                  {% else %}
                    Ï¢ÖÎ£å
                  {% endif %}
                </span>
                <span class="px-3 py-1 bg-purple-500 rounded-full text-xs font-bold text-white shadow-sm">
                  {{ cafe.get_cafe_type_display }}
                </span>
              </div>
              <h1 class="text-xl md:text-2xl lg:text-3xl font-bold text-white mb-1 break-words">{{ cafe.cafe_name }}</h1>
              <p class="text-base md:text-lg text-white opacity-90">{{ cafe.artist.display_name }}{% if cafe.member %} - {{ cafe.member.member_name }}{% endif %}</p>
            </div>
          </div>
        </div>
      {% else %}
        <div class="w-full h-[500px] bg-gradient-to-br from-gray-300 to-gray-500 flex items-center justify-center">
          <span class="text-white text-6xl">üè™</span>
        </div>
      {% endif %}
    {% endwith %}

    <!-- Ï∞ú Î≤ÑÌäº -->
    {% if user.is_authenticated and cafe.status == 'approved' %}
      <div class="absolute top-2 right-2 z-40 flex items-center justify-center">
        <button 
          data-favorite-btn 
          data-cafe-id="{{ cafe.id }}" 
          class="favorite-button w-12 h-12 md:w-14 md:h-14 text-xl md:text-2xl bg-black bg-opacity-50 backdrop-blur-sm rounded-full hover:bg-opacity-70 transition-all focus:outline-none cursor-pointer shadow-lg {% if cafe.id in user_favorites %}favorited{% else %}not-favorited{% endif %}"
          style="color: {% if cafe.id in user_favorites %}#ef4444{% else %}#ffffff{% endif %};"
          title="{% if cafe.id in user_favorites %}Ï∞ú Ìï¥Ï†ú{% else %}Ï∞úÌïòÍ∏∞{% endif %}"
        >
          <span class="favorite-icon">{% if cafe.id in user_favorites %}‚ô•{% else %}‚ô°{% endif %}</span>
        </button>
      </div>
    {% endif %}
  </div>
</div>