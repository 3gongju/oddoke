<!-- ddoksang/templates/ddoksang/components/detail/_nearby_cafes.html -->
<!-- ì£¼ë³€ ìƒì¼ì¹´í˜ ë¦¬ìŠ¤íŠ¸ -->

<div id="nearbyCafeContainer" class="bg-white rounded-2xl shadow-sm border p-6">
  <h3 class="font-bold text-gray-900 mb-4 flex items-center">
    <span class="mr-2">ğŸ“</span> ìš´ì˜ì¤‘/ì˜ˆì • ìƒì¼ì¹´í˜
    {% if nearby_cafes %}
      <span class="ml-auto text-xs text-gray-500 font-normal">{{ nearby_cafes|length }}ê°œ</span>
    {% endif %}
  </h3>
  <div id="nearbyCafeList" class="space-y-3">
    {% if nearby_cafes %}
      {% for nearby_cafe in nearby_cafes %}
        <div class="nearby-cafe-card flex items-center space-x-3 p-3 rounded-lg cursor-pointer hover:shadow-lg hover:border-blue-300 transition-all duration-200 border border-gray-200" 
             onclick="location.href='{% url 'ddoksang:detail' nearby_cafe.id %}'">
          
          <!-- ğŸ”§ ì´ë¯¸ì§€ ì²˜ë¦¬ ê°œì„  -->
          {% if nearby_cafe.main_image %}
            <img src="{{ nearby_cafe.main_image }}" alt="{{ nearby_cafe.cafe_name }}" 
                 class="w-14 h-14 rounded-lg object-cover flex-shrink-0 shadow-sm">
          {% else %}
            <div class="w-14 h-14 bg-gradient-to-br from-gray-100 to-gray-200 rounded-lg flex items-center justify-center flex-shrink-0 shadow-sm">
              <span class="text-gray-400 text-lg">ğŸ‚</span>
            </div>
          {% endif %}
          
          <div class="flex-1 min-w-0">
            <div class="flex items-center space-x-2 mb-1.5">
              <h4 class="text-sm font-semibold text-gray-900 truncate">{{ nearby_cafe.cafe_name }}</h4>
              <!-- ğŸ”§ ê´€ë ¨ ì¹´í˜ í‘œì‹œ (ê°™ì€ ë©¤ë²„/ì•„í‹°ìŠ¤íŠ¸) -->
              {% if nearby_cafe.artist == cafe.artist %}
                <span class="related-badge flex-shrink-0">ê´€ë ¨</span>
              {% endif %}
            </div>
            
            <p class="text-xs text-gray-600 truncate mb-2">
              {{ nearby_cafe.artist }}{% if nearby_cafe.member %} - {{ nearby_cafe.member }}{% endif %}
            </p>
            
            <div class="flex items-center space-x-2">
              <!-- ğŸ”§ ê±°ë¦¬ í‘œì‹œ -->
              <span class="distance-badge">{{ nearby_cafe.distance|floatformat:1 }}km</span>
              
              <!-- ğŸ”§ ë„ë³´ ì‹œê°„ ê³„ì‚° -->
              {% if nearby_cafe.walk_time %}
                <span class="text-xs text-gray-500">ğŸš¶â€â™‚ï¸ {{ nearby_cafe.walk_time }}ë¶„</span>
              {% endif %}
              
              <!-- ğŸ”§ ìƒíƒœ í‘œì‹œ ê°œì„  -->
              {% if nearby_cafe.is_active %}
                <span class="text-xs bg-green-100 text-green-700 px-2 py-0.5 rounded-full font-medium">ìš´ì˜ì¤‘</span>
              {% elif nearby_cafe.days_until_start > 0 %}
                <span class="text-xs bg-blue-100 text-blue-700 px-2 py-0.5 rounded-full font-medium">{{ nearby_cafe.days_until_start }}ì¼ í›„</span>
              {% else %}
                <span class="text-xs bg-gray-100 text-gray-600 px-2 py-0.5 rounded-full">ì¢…ë£Œ</span>
              {% endif %}
            </div>
          </div>
          
          <div class="flex-shrink-0">
            <svg class="w-4 h-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
            </svg>
          </div>
        </div>
      {% endfor %}
      
      <!-- ğŸ”§ ê´€ë ¨ ì¹´í˜ ì„¤ëª… -->
      {% if nearby_cafes|length > 0 %}
        <div class="mt-4 pt-3 border-t border-gray-100">
          <p class="text-xs text-gray-500 flex items-center">
            <span class="related-badge mr-2">ê´€ë ¨</span>
            ê°™ì€ ì•„í‹°ìŠ¤íŠ¸/ë©¤ë²„ì˜ ìƒì¼ì¹´í˜
          </p>
        </div>
      {% endif %}
    {% else %}
      <div class="text-center py-6">
        <div class="w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-3">
          <span class="text-gray-400 text-2xl">ğŸ”</span>
        </div>
        <p class="text-sm text-gray-500">ìš´ì˜ì¤‘/ì˜ˆì • ì¹´í˜ê°€ ì—†ìŠµë‹ˆë‹¤</p>
        <p class="text-xs text-gray-400 mt-1">50km ë°˜ê²½ ë‚´ ê²€ìƒ‰ ê²°ê³¼ (ì¢…ë£Œëœ ì¹´í˜ ì œì™¸)</p>
      </div>
    {% endif %}
  </div>
</div>

<!-- ğŸ”§ ë””ë²„ê¹… ì •ë³´ (ê°œë°œ ì¤‘ì—ë§Œ í‘œì‹œ) -->
{% if settings.DEBUG %}
<div class="mt-2 text-xs text-gray-400">
  <!-- ë””ë²„ê¹…: nearby_cafes ë³€ìˆ˜ í™•ì¸ -->
  ë””ë²„ê·¸: nearby_cafes íƒ€ì… = {{ nearby_cafes|length }}ê°œ 
  {% if cafe.member %}
    | í˜„ì¬ ì¹´í˜ ë©¤ë²„: {{ cafe.member.member_name }}
  {% endif %}
</div>
{% endif %}