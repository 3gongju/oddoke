{# templates/ddoksang/detail.html #}
{% extends "ddoksang/base/ddoksang_base.html" %}
{% load static filters %}

{% block title %}{{ cafe.cafe_name }} - {{ cafe.artist.display_name }}{% endblock %}

{% block extra_css %}
<link href="{% static 'css/ddoksang_detail.css' %}" rel="stylesheet">
{% endblock %}

{% block ddoksang_content %}
  {# 1. 상태 알림 배너 #}
  {% include "ddoksang/components/detail/_status_banner.html" %}

  {# 2. 헤더 이미지 슬라이드 #}
  {% include "ddoksang/components/detail/_image_header.html" %}

  <div class="max-w-4xl mx-auto px-4 py-8">
    <div class="lg:flex lg:space-x-8">
      
      {# 왼쪽 메인 컬럼 #}
      <div class="flex-1 space-y-6">
        {% include "ddoksang/components/detail/_cafe_basic_info.html" %}
        {% include "ddoksang/components/detail/_cafe_map.html" %}
        {% include "ddoksang/components/detail/_gallery_section.html" %}
      </div>

      {# 오른쪽 사이드바 #}
      <aside class="w-80 space-y-6">
        {% include "ddoksang/components/detail/_nearby_cafes.html" %}
        {% include "ddoksang/components/detail/_related_cafes.html" %}
        {% include "ddoksang/components/detail/_share_section.html" %}
      </aside>

    </div>
  </div>
{% endblock %}
<!-- {# _cafe_map.html (또는 detail.html) 안에) #} -->
<!-- ① Kakao SDK 로드 (HTML에서) -->
<script src="https://dapi.kakao.com/v2/maps/sdk.js?appkey={{ kakao_api_key }}"></script>

<!-- ② JSON 데이터 덤프 (HTML에서) -->
<script id="cafe-data" type="application/json">
{
  "latitude": {{ cafe.latitude|default:"37.5665" }},
  "longitude": {{ cafe.longitude|default:"126.9780" }},
  "images": [
    {% for image in cafe.get_all_images %}
      {
        "url":     "{{ image.url|escapejs }}",
        "type":    "{{ image.type_display|escapejs }}",
        "caption": "{{ image.caption|escapejs }}"
      }{% if not forloop.last %},{% endif %}
    {% endfor %}
  ],

}
</script>

<!-- {# ③ 순수 JS 파일 로드 (HTML에서) #} -->
<script src="{% static 'js/ddoksang_detail.js' %}"></script>

