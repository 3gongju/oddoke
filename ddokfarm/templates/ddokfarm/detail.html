{% extends 'base.html' %}

{% block body %}
<div class="max-w-5xl mx-auto px-4 py-10 bg-white rounded-lg shadow">

    <!-- 게시글 제목 + 작성자 정보 -->
    {% include 'components/post/_header_ui.html' with post=post %}

    <!-- 게시글 상세 내용 -->
    {% include 'components/post/_content_ui.html' with post=post %}

    <!-- 수정/삭제/판매완료 버튼 -->
    {% if user == post.user %}
    <div class="flex justify-end space-x-2 my-4">
        <!-- 수정 버튼 -->
        <a href="{% url 'ddokfarm:update' post.id %}" class="bg-blue-500 text-white px-4 py-2 rounded">
            수정
        </a>

        <!-- 삭제 버튼 (POST) -->
        <form method="POST" action="{% url 'ddokfarm:delete' post.id %}">
            {% csrf_token %}
            <button type="submit" class="bg-red-500 text-white px-4 py-2 rounded">
                삭제
            </button>
        </form>

        <!-- 판매완료 토글 버튼 (POST) -->
        <form method="POST" action="{% url 'ddokfarm:mark_as_sold' post.id %}">
            {% csrf_token %}
            <button type="submit" class="bg-gray-700 text-white px-4 py-2 rounded">
                {% if post.is_sold %}
                    판매중으로 변경
                {% else %}
                    판매완료로 변경
                {% endif %}
            </button>
        </form>
    </div>
    {% endif %}

    <!-- 댓글 작성 폼 -->
    {% include 'components/comment/_form_ui.html' with post=post form=form %}

    <!-- 댓글 목록 -->
    {% include 'components/comment/_list_ui.html' with comments=comments post=post %}

</div>
{% endblock %}
