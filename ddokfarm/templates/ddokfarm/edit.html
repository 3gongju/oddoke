{% extends 'base.html' %}
{% load static %}

{% block body %}
<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-10">
  <!-- 헤더 -->
  {% include 'ddokfarm/components/_header.html' %}

  <!-- 카테고리 선택 -->
  {% include 'components/post_form/_category_buttons.html' %}

  <!-- 작성 폼 -->
  <div class="flex justify-center">
    <form method="post" enctype="multipart/form-data" id="edit-form"
          class="w-full max-w-2xl bg-white p-6 rounded-xl shadow-lg">
      {% csrf_token %}
      {% include 'components/post_form/_form_base.html' %}
    </form>
  </div>
</div>

{{ existing_images|json_script:"existing-images-data" }}
<script>
  window.ajaxBaseUrl = "{{ ajax_base_url }}";
  window.selectedMemberIds = {{ selected_member_ids|default:"[]"|safe }};

  const dataEl = document.getElementById("existing-images-data");
  let existingImages = [];
  if (dataEl && dataEl.textContent.trim()) {
    existingImages = JSON.parse(dataEl.textContent.trim());
  }
  window.existingImages = existingImages;
  console.log("기존 이미지:", window.existingImages);
</script>
<script src="https://cdn.jsdelivr.net/npm/sortablejs@latest/Sortable.min.js"></script>
<script type="module" src="{% static 'js/post_form_edit.js' %}"></script>

{% endblock %}